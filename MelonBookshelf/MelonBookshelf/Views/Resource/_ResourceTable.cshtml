@using MelonBookshelf.Data
@model ResourcePageViewModel

<table class="table">
    <thead>
        <tr class="text-center">
            <th>Type</th>
            <th>Category</th>
            <th>Author</th>
            <th>Title</th>
            <th>Wanters</th>
        </tr>
    </thead>
    <tbody>
        @foreach (var item in Model.Resources)
        {
            <tr>
                <td class="align-middle">
                    @Html.DisplayFor(modelItem => item.Type)
                </td>
                <td class="align-middle">
                    @Html.DisplayFor(modelItem => item.Category.Name)
                </td>
                <td class="align-middle">
                    @Html.DisplayFor(modelItem => item.Author)
                </td>
                <td class="align-middle">
                    @Html.DisplayFor(modelItem => item.Title)
                </td>



                @if (item.Type == ResourceType.Physical)
                {
                    <td class="align-middle">
                        @Html.DisplayFor(modelItem => item.wantedResources.Count)
                    </td>
                }
                else
                {
                    <td class="align-middle">
                        <p> </p>
                    </td>
                }
                @if (User.IsInRole("Admin") && item.Type != ResourceType.Physical)
                {
                    <td class="align-middle">
                        <form method="post" enctype="multipart/form-data" asp-action="Upload">
                            <div class="form-group">
                                <div class="classcol-md-8 offset-md-2">
                                    <input type="file" name="file" />
                                </div>
                            </div>
                            <input type="hidden" name="resourceId" value="@item.ResourceId" />
                            <div class="form-group">
                                <div class="classcol-md-8 offset-md-2">
                                    <input type="submit" value="Upload" />


                                </div>
                            </div>
                        </form>

                    </td>
                }
                @if (item.Type != ResourceType.Physical)
                {
                    <td class="align-middle">
                        @if (!string.IsNullOrEmpty(item.Location))
                        {
                            <a href="@Url.Action("Download", "Resource", new { resourceId = item.ResourceId })" class="btn btn-primary">Download</a>
                        }
                        else
                        {
                            <span>No File Available</span>
                        }
                    </td>

                }
                else
                {
                    @if (item.Want == true)
                    {
                        <td class="align-middle">
                            <a class="btn btn-success btn-sm" asp-action="Unwant" asp-route-resourceId="@item.ResourceId">Want</a>
                        </td>
                    }
                    else
                    {
                        <td class="align-middle">
                            <a class="btn btn-outline-success btn-sm" asp-action="Want" asp-route-resourceId="@item.ResourceId">Want</a>
                        </td>
                    }
                }
                <td class="align-middle">
                    @if (item.Type == ResourceType.Physical)
                    {

                    }
                    @if (User.IsInRole("Admin"))
                    {
                        <a class="btn btn-outline-warning" asp-action="Edit" asp-route-id="@item.ResourceId" data-ajax="true" data-ajax-method="get" data-ajax-mode="replace" data-ajax-update="#editPartial" data-ajax-success="showModal()">Edit</a>
                    }
                </td>
            </tr>
        }
    </tbody>
</table>